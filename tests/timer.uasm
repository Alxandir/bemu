.include beta.uasm

. = VEC_RESET
reset: BR(start)
. = VEC_II
       BR(illop)
. = VEC_CLK
       BR(clock)

illop:
        HALT()

clock:
        ADDC(R0, 1, R0)
        ADDC(XP, -4, XP)
        JMP(XP)

start:
        CMOVE(0, R0)
        || Lose the supervisor bit, so we get interrupts
        CMOVE(spin, R1)
        JMP(R1)
spin:
        CMPLTC(R0, 100, R1)
        BT(R1, spin)
        HALT()
